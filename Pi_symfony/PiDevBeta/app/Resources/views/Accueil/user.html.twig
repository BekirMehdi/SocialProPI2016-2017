{% extends ':CurriculaVitae:base.html.twig' %}

{% block body %}
    <div class="page">
        <div class="page-content container-fluid">
            <div class="row">
                <!-- Middle Column -->
                <div class="col-lg-12 col-xl-6 push-xl-3">

                    <!-- User Background -->
                    <div class="user-background card card-shadow">
                        <div class="card-header card-header-transparent p-20">
                            <h4 class="card-title mb-0">Background</h4>
                        </div>
                        <div class="card-block">
                            <h5 class="card-title">
                                <i class="icon md-clipboard"></i>
                                <span>Summary</span>
                            </h5>
                            <p class="card-text">
                                {{ user.description }}
                            </p>
                        </div>
                        <div class="card-block">
                            <h5 class="card-title">
                                <i class="icon md-briefcase"></i>
                                <span>Experience</span>
                            </h5>
                            <ul class="timeline timeline-single" id="expList">
                                {% for e in cv %}
                                    {% if e.type =="Experience" %}
                                        <li class="timeline-item" id="listExperance{{ e.idCv }}">
                                            <div class="timeline-dot"></div>
                                            <div class="timeline-content">
                                                <img class="float-right" src="{{ asset("template/global/portraits/"~ e.file)}}" alt="...">
                                                <span class="block font-size-15 mb-5"> {{ e.local }} {{ e.place }} </span>
                                                <span class="block mb-5">{{ e.post }}</span>
                                                <span class="block mb-5">From {{ e.datefrom |date('Y-m-d')}} To {{ e.dateto|date('Y-m-d') }}</span>
                                                <span class="block mb-5">{{ e.description }}</span>
                                            </div>
                                        </li>
                                    {% endif %}
                                {% endfor %}
                            </ul>
                        </div>


                        {% for e in cv %}

                            {% if e.type =="Expérience de bénévolat" %}

                            {% endif %}
                        {% endfor %}
                        {% for e in cv %}

                            {% if e.type =="Formation" %}

                            {% endif %}
                        {% endfor %}
                        {% for e in cv %}

                            {% if e.type =="Certifications" %}

                            {% endif %}
                        {% endfor %}
                        {% for e in cv %}

                            {% if e.type =="Projets" %}

                            {% endif %}
                        {% endfor %}
                        {% for e in cv %}

                            {% if e.type =="Résultats d’examens" %}

                            {% endif %}
                        {% endfor %}
                        {% for e in cv %}

                            {% if e.type =="Brevets" %}

                            {% endif %}
                        {% endfor %}
                        {% for e in cv %}

                            {% if e.type =="Prix et distinctions" %}

                            {% endif %}
                        {% endfor %}
                    </div>
                    <!-- End User Background -->

                </div>
                <!-- End Middle Column -->
                <!-- Left Column -->
                <div class="col-lg-6 col-xl-3 pull-xl-6">
                    <div class="user-info card card-shadow text-center">
                        <div class="user-base card-block">
                            <a class="avatar img-bordered avatar-100" href="javascript:void(0)">
                                <img src="{{ asset("template/global/portraits/"~ user.photo)}}" alt="...">
                            </a>
                            <h4 class="user-name"> {{ user.firstname }} {{ user.lastname }}  </h4>
                            <p class="user-job">{{ user.slogan }}</p>
                            <p class="user-location">Ariana , TUNISIA</p>
                        </div>
                        <div class="user-actions" id="doit">
                            {% for a in friends %}
                                {%  if (a.idfriend.id == app.user.id) and (a.iduser.id== user.id) %}
                                    <button class="btn btn-primary btn-round waves-effect waves-light waves-round" type="button" id="followHim{{ user.id }}" name="follow">Follow</button>

                                {% elseif (a.idfriend.id != app.user.id) and (a.iduser.id != user.id) %}
  <button class="btn btn-danger btn-round waves-effect waves-light waves-round" type="button" id="unfollowHim{{ user.id }}" name="follow">Unfollow</button>

                                {% endif %}
                            {% endfor %}

                        </div>
                        <div class="user-stats">
                            <a class="user-stat counter" href="javascript:void(0)">
                                <span class="counter-number font-size-16">{{ following }}</span>
                                <span class="counter-label inline-block ml-5">Following</span>
                            </a>
                            <a class="user-stat counter p-15" href="javascript:void(0)">
                                <span class="counter-number font-size-16">{{ followers }}</span>
                                <span class="counter-label inline-block ml-5">Followers</span>
                            </a>
                        </div>
                        <div class="user-socials list-group list-group-full">
                            <a class="list-group-item justify-content-center" href="javascript:void(0)">
                                <i class="icon bd-facebook"></i> {{ user.smFb }}
                            </a>
                            <a class="list-group-item justify-content-center" href="javascript:void(0)">
                                <i class="icon bd-linkedin"></i>{{ user.smLin }}
                            </a>
                            <a class="list-group-item justify-content-center" href="javascript:void(0)">
                                <i class="icon bd-google-plus"></i> {{ user.smGplus }}
                            </a>
                        </div>
                    </div>
                    <!-- End User Info -->
                    <!-- Friend List -->
                    <div class="user-friends card card-shadow">
                        <div class="card-block">
                            <h4 class="card-title mb-20">
                                Friends
                                <span>{{ following }}</span>
                            </h4>
                            <ul class="list-group list-group-full m-0">
                                {% for ami in friends %}

                                    <li class="list-group-item">
                                        <div class="media">
                                            <div class="pr-20">
                                                <a class="avatar avatar-online" href="{{ path('display', { 'id': ami.idfriend.id }) }}">
                                                    <img class="img-fluid" src="{{ asset("template/global/portraits/"~ ami.idfriend.photo)}}"alt="...">
                                                    <i></i>
                                                </a>
                                            </div>
                                            <div class="media-body">
                                                <h4 class="mt-0 mb-5 hover">
                                                    {{ ami.idfriend.firstname }} {{ ami.idfriend.lastname }}
                                                </h4>
                                                <small>{{ ami.idfriend.username }}</small>
                                            </div>
                                        </div>
                                    </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                    <!-- End Friends List -->
                </div>
                <!-- End Left Column -->
            </div>
        </div>
    </div>



{% endblock %}
{% block javascripts %}

    <script type="text/javascript">
        $(document).ready(function () {
            $(".btn-primary ").on('click', function() {

                var id = $(this).attr('id');
                if (id.indexOf('followHim') != -1) {

                    id = id.replace("followHim","");
                    var url4 = '{{ path("follow", {'id': 'id'}) }}';
                $.ajax({
                    url: url4.replace("id", id),
                    success: function (result) {

                        var test = "followHim";
                        var r= $('<button class="btn btn-danger btn-round waves-effect waves-light waves-round" type="button" id="unfollowHim'+id+'" name="follow">Unfollow</button>');
                        var c = test + id;
                        $('#' + c).fadeOut();
                        $('#doit').append(r);
                    } })}


            })

            $(".btn-danger ").on('click', function() {

                var id = $(this).attr('id');
                if (id.indexOf('unfollowHim') != -1) {

                    id = id.replace("unfollowHim","");
                    var url4 = '{{ path("unfollow", {'id': 'id'}) }}';
                    $.ajax({
                        url: url4.replace("id", id),
                        success: function (result) {

                            var test = "unfollowHim";
                            var r= $('<button class="btn btn-primary btn-round waves-effect waves-light waves-round" type="button" id="followHim'+id+'" name="follow">Follow</button>');
                            var c = test + id;
                            $('#' + c).fadeOut();
                            $('#doit').append(r);
                        } })}
            })

        });
    </script>

{% endblock %}